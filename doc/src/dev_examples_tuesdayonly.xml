<?xml version="1.0" ?>
<article short="tuesdayonly" title="tuesdayonly - A minimal module">

<!-- ----+---------+---------+---------+---------+---------+---------+----- -->
<content>

<p>
This shows the bare minimum code required to implement a SconeServer module. 
Its not intended to be particularly useful, but could be used as a template 
for other simple modules.
</p>

<p>
The module is called "tuesdayonly", and its purpose is to only allow 
connections on tuesdays! It doesn't do any actual communications - it just 
decides whether a connection should be accepted or not by returning either
true or false from the Module::connect() method.
</p>

<p>
Being very simple, this module can be implemented in a single source file. 
Anything more complicated than this would generally be better split into 
separate source files and headers. 
</p>

<?WMG
  $ex_path = '../examples/tuesdayonly';
  $src->read_file("$ex_path/TuesdayOnly.cpp"); 
?>

<p>
Note that the <code>SCONESERVER_MODULE</code> declaration 
<strong>must</strong> be present in order to allow the resulting shared object
to be used as a SconeServer module. It should be declared 
<strong>once</strong> - preferably in the source file containing the module 
class. This is because it expands to implement a standard entry point, which
constructs and returns an instance of the module class.
</p>

<h3>Building the module</h3>

<p>
This should be fairly straightforward provided SconeServer has been installed,
basically you need to link with libsconex, producing a shared object or 
dynamic link library. For example, using gcc, this can be done with:
</p>

<pre class='shell'>
<b>$</b> g++ -shared -lsconex -o tuesdayonly.so TuesdayOnly.cpp
</pre>

<h3>Loading into SconeServer</h3>

<p>
The module binary should be named "tuesdayonly.so" on Linux/UNIX-like systems,
or "tuesdayonly.dll" on Windows systems. This should be copied to 
SconeServer's module directory (mod_path). The module can then be loaded with 
the SconeScript command:

<pre class='script'>
insmod("tuesdayonly")
</pre>

<p>
Add this to "sconeserver.conf" if you want the module to be loaded every time 
SconeServer starts.
</p>

<h3>Using the module</h3>

<p>
The module can be used to control access to any module(s) following it in its
route chain. Assuming the module has been built and loaded into SconeServer
(see above), if we set up a route chain like this (either in sconeserver.conf, 
or from a configuration console):
</p>

<pre class='script'>
router.add("tuesweb");
 router.tuesweb.add("tuesdayonly");
 router.tuesweb.add("http");
</pre>

<p>
Then our module "tuesdayonly" will act as a filter on the "tuesweb" route chain
- only allowing connections to pass through to the "http" module (which could 
be, for example, a web server) on tuesdays.
</p>

</content>
<!-- ----+---------+---------+---------+---------+---------+---------+----- -->

</article>
